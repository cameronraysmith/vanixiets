if ! has nix_direnv_version || ! nix_direnv_version "3.0.7"; then
  source_url "https://raw.githubusercontent.com/nix-community/nix-direnv/3.0.7/direnvrc" "sha256-bn8WANE5a91RusFmRI7kS751ApelG02nMcwRekC/qzc="
fi

# direnv-instant (configured via home-manager) handles async loading
# Long builds automatically spawn a tmux pane after mux_delay
if ! use flake .#default --accept-flake-config; then
  echo "nix flake could not be built; update flake.nix and run direnv allow/reload" >&2
fi

dotenv
